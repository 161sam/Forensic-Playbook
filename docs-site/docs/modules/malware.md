<!-- AUTODOC:BEGIN -->
---
title: "Malware Analysis Module"
description: "Berechnet Hashes, führt YARA-Scans und sammelt Metadaten zu verdächtigen Dateien."
---

# Zusammenfassung

- **Kategorie:** Analysis
- **CLI-Name:** `malware`
- **Guard-Level:** Medium — read-only Scans, optional YARA.
- **Unterstützte Evidenz:** filesystem paths
- **Backends/Extras:** Python hashlib, optional YARA
- **Abhängigkeiten:** yara (optional)
- **Optionale Extras:** yara

## Parameterreferenz
| Parameter | Pflicht | Standard | Beschreibung |
| --- | --- | --- | --- |
| `path` | Yes | — | Datei- oder Verzeichnispfad. |
| `recursive` | No | true | Unterordner rekursiv scannen. |
| `yara_rules` | No | config | Pfad zu YARA-Regeln. |
| `hash_algorithms` | No | sha256,sha1,md5 | Hashes, die berechnet werden sollen. |
| `max_file_size` | No | config | Grenze für Scan-Größe. |

> **Konfigurations-Hinweis:** CLI-Werte überschreiben YAML (`config/modules/`), die wiederum die eingebauten Defaults überstimmen.

## CLI-Beispiele
**Dry-Run**
```bash
forensic-cli modules run malware --case demo_case --param path=cases/demo_case/analysis/filesystem/export --dry-run
```

**Ausführung**
```bash
forensic-cli modules run malware --case demo_case --param path=cases/demo_case/analysis/filesystem/export --param yara_rules=config/yara/high_confidence.yar
```

## Ausgaben & Provenienz
- Hash-Reports und optional YARA-Treffer im analysis/malware/-Ordner.
- CSV/JSON-Listen mit Verdachtsmomenten.

**Chain of Custody:** Trefferlisten enthalten Hashes, Speicherorte, YARA-Regeln mit Referenzen im Provenienz-Log.

## Guard-Fehlermeldungen
- Guard-Warnung bei fehlenden YARA-Binärdateien (Status `partial`).
- Fehler, wenn Pfad nicht existiert oder keine Dateien gelesen werden können.

## Verwandte Dokumentation
- [Analysis](../modules/analysis.md)
- [Ioc Hunting](../examples/ioc-hunting.md)

<!-- AUTODOC:END -->
